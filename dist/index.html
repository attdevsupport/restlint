<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>REST Lint</title><link href="https://netdna.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet"><style>.bfd-dropfield{display:inline;padding:5px}.bfd-dropfield-inner{border:5px dashed #888;color:#888;cursor:pointer;font-size:32px;text-align:center}.bfd-dropfield-inner.bfd-dragover,.bfd-dropfield-inner:hover{border-color:#bbb;color:#bbb}.bfd-info{overflow:hidden;white-space:nowrap}.bfd-error-message{text-align:center}.bfd-remove{cursor:pointer}</style></head><body class="container"><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script src="https://netdna.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><script lang="javascript" src="js/xlsx.full.min.js"></script><script src="js/bootstrap.fd.js"></script><script src="js/restlintlib.js"></script><script type="text/javascript">var xlsdata = {};
        function clearTables() {
            getCategories().forEach(function(k) {
                $("#"+k+"-table-body").children("tr").remove();
                $("#"+k+"-issues").html('');
            });
            $("#summary-table-footer").children("tr").remove();
            
            return;
        }

        function onReaderLoad(event){
            // var obj = JSON.parse(event.target.result);
            loadJson(event.target.result);
            checkGeneral();
            checkPathStructure('paths', getData('paths'));
            checkResources(getData('paths'));
            checkBasePath();
            checkStatusCodes(getData('statuscodes'));
            // checkMethods(getData('statuscodes'));
            checkMethods(getData('httpmethods'));

            // var xlsdata = {};
            xlsdata['summary'] = [];
            xlsdata['summary'].push(['Category', '# of Infos', '# of Warnings', '# on Errors', 'Total']);
            var wt = 0, et = 0, it = 0;
            var cats = getCategories();
            // var index = cats.indexOf('summary');
            // cats.splice(index, 1);
            cats.forEach(function(cat, idx) {
                if (cat === 'summary') {return;}
                console.log('CAT: ' + cat);
                xlsdata[cat] = [];
                xlsdata[cat].push(['#', 'Issue', 'Level', 'Message']);
                var w = 0, e = 0, i = 0, cnt = 1;
                getErrors(cat).forEach(function(key) {
                    addRow(cat, cnt, key.name, key.level, key.msg);
                    // xlsdata[cat].push([cnt, key.name, key.level, key.msg]);
                    cnt += 1;
                    if (key.level === 'warning') {
                        w++;
                    } else if (key.level === 'error') {
                        e++;
                    } else if (key.level === 'info') {
                        i++;
                    }
                });
                $('#' + cat + '-issues').html(`Total ${capitalize(cat)} issues: ${w+e+i}; error: ${e}; warning: ${w}; info: ${i}`);
                addSummaryRow(cat, i, w, e);
                // xlsdata['summary'].push([cat, i, w, e, i+w+e]);
                it += i;
                wt += w;
                et += e;
            });

            addSummaryRow('total', it, wt, et);
            // xlsdata['summary'].push(['total', it, wt, et, it+wt+et]);

            return;
        };

        function addRow(cat, num, item, level, msg) {
            var lvl = level;
            if (level === 'error') {
                lvl = 'danger';
            }
            row = $("<tr class='" + lvl + "'></tr>");
            cells = `<td>${num}</td><td>${item}</td><td>${msg}</td>`;
            // cells = `<td>${num}</td><td>${item}</td><td>${level}</td><td>${msg}</td>`;
            row.append(cells);
            $("#" + cat + "-table-body").append(row);
            xlsdata[cat].push([num, item, level, msg]);
            return;
        };

        function addSummaryRow(cat, infos, warnings, errors) {
            var total = infos + warnings + errors;
            if (cat === 'total') {
                row = `<tr><th>${capitalize(cat)}</th><th class='info'>${infos}</th><th class='warning'>${warnings}</th><th class='danger'>${errors}</th><th>${total}</th></tr>`;
                $("#summary-table-footer").append(row);
            } else {
                row = `<tr><td>${capitalize(cat)}</td><td class='info'>${infos}</td><td class='warning'>${warnings}</td><td class='danger'>${errors}</td><td>${total}</td><tr>`;
                $("#summary-table-body").append(row);
            }
            xlsdata['summary'].push([capitalize(cat), infos, warnings, errors, total]);
            return;
        };



        $(document).ready(function() {
// $('#paths-table').on('click-row.bs.table', function (e, row, $element) {
//     alert(row, $element);
// });

// $('#paths-table').bootstrapTable({
//     onClickRow: function (row, $element) {
//         alert(row, $element);
//     };
// });

            $('.nav-tabs a[href="#parameters"]').tab('show');
            $('.nav-tabs a[href="#summary"]').tab('show');
            $("#open_btn").click(function() {
                $.FileDialog({multiple: true, accept: "text/csv, application/json"}).on('files.bs.filedialog', function(ev) {
                    clearTables();
                    clearData();
                    var files = ev.files;
                    var text = [], cells, row;
                    files.forEach(function(f) {
                        var reader = new FileReader();
                        reader.onload = onReaderLoad;
                        reader.readAsText(f);
                        text.push(f.name);
                    });
                    $("#output").html("Checking files: " + text.join(','));
                    
                }).on('cancel.bs.filedialog', function(ev) {
                    // $("#output").html("Cancelled!");
                });
            });
            $("#clear_btn").click(function() {
                clearTables();
                clearData();
            });
            $("#export_btn").click(function() {
                var wb = XLSX.utils.book_new();
console.log(getCategories());
                getCategories().forEach(function(key, idx) {
                    console.log('TABLE: ' + key);
                    // var tbl = document.getElementById(key + '-table');
                    // var ws = XLSX.utils.table_to_sheet(tbl);
                    var ws = XLSX.utils.aoa_to_sheet(xlsdata[key]);
                    var ws_name = capitalize(key);

                    // /* make worksheet */
                    // var ws_data = [
                    //   [ "S", "h", "e", "e", "t", "J", "S" ],
                    //   [  1 ,  2 ,  3 ,  4 ,  5 ]
                    // ];
                    // var ws = XLSX.utils.aoa_to_sheet(ws_data);

                    /* Add the worksheet to the workbook */
                    XLSX.utils.book_append_sheet(wb, ws, ws_name);
                });

                XLSX.writeFile(wb, 'out.xlsb');
                delete wb;
            });
         });</script><br><h2>RestLint - A ReST API Design Static Checker</h2><br><button id="open_btn" class="btn btn-primary">Open files</button> <button id="clear_btn" class="btn btn-secondary">Clear</button> <button id="export_btn" class="btn btn-secondary">Export</button><br><h4 id="output"></h4><br><ul class="nav nav-tabs"><li class="active"><a data-toggle="tab" href="#summary">Summary</a></li><li><a data-toggle="tab" href="#general">General</a></li><li><a data-toggle="tab" href="#http-methods">HTTP Methods</a></li><li><a data-toggle="tab" href="#paths">Paths</a></li><li><a data-toggle="tab" href="#parameters">Parameters</a></li><li><a data-toggle="tab" href="#status-codes">Status Codes</a></li><li><a data-toggle="tab" href="#errors">Exceptions</a></li></ul><div class="tab-content"><div id="summary" class="tab-pane fade in active"><table id="summary-table" class="table table-hover table-sm table-responsive table-condensed table-striped"><thead><tr><th scope="col">Category</th><th scope="col"># of Infos</th><th scope="col"># of Warnings</th><th scope="col"># of Errors</th><th scope="col">Total</th></tr></thead><tfoot id="summary-table-footer"></tfoot><tbody id="summary-table-body"></tbody></table><h5 id="summary-issues"></h5></div><div id="general" class="tab-pane fade in active"><table id="general-table" class="table table-hover table-sm table-responsive table-condensed"><thead><tr><th scope="col">#</th><th scope="col">Issue</th><th scope="col">Message</th></tr></thead><tbody id="general-table-body"></tbody></table><h5 id="general-issues"></h5></div><div id="http-methods" class="tab-pane fade in active"><table id="http-methods-table" class="table table-hover table-sm table-responsive table-condensed"><thead><tr><th scope="col">#</th><th scope="col">Issue</th><th scope="col">Message</th></tr></thead><tbody id="http-methods-table-body"></tbody></table><h5 id="http-methods-issues"></h5></div><div id="paths" class="tab-pane fade in active"><table id="paths-table" class="table table-hover table-sm table-responsive table-condensed"><thead><tr><th scope="col">#</th><th scope="col">Issue</th><th scope="col">Message</th></tr></thead><tbody id="paths-table-body"></tbody></table><h5 id="paths-issues"></h5></div><div id="parameters" class="tab-pane fade in active"><h3>NOT IMPLEMENTED YET</h3><table id="parameters-table" class="table table-hover table-sm table-responsive table-condensed"><thead><tr><th scope="col">#</th><th scope="col">Issue</th><th scope="col">Message</th></tr></thead><tbody id="parameters-table-body"></tbody></table></div><div id="status-codes" class="tab-pane fade in active"><table id="status-codes-table" class="table table-hover table-sm table-responsive table-condensed"><thead><tr><th scope="col">#</th><th scope="col">Issue</th><th scope="col">Message</th></tr></thead><tbody id="status-codes-table-body"></tbody></table><h5 id="status-codes-issues"></h5></div><div id="errors" class="tab-pane fade in active"><h3>NOT IMPLEMENTED YET</h3><table id="errors-table" class="table table-hover table-sm table-responsive table-condensed"><thead><tr><th scope="col">#</th><th scope="col">Issue</th><th scope="col">Message</th></tr></thead><tbody id="errors-table-body"></tbody></table></div></div><div class="panel-group"><div class="panel panel-default"><div class="panel-heading"><h4 class="panel-title text-center"><a data-toggle="collapse" href="#collapse1">Legend</a></h4></div><div id="collapse1" class="panel-collapse collapse"><div class="panel-body"><table id="parameters-table" class="table table-hover table-sm table-responsive"><tbody><tr><td scope="col" class="info col-sm-4"><small><b>info</b> - There is not enough information to make a solid determination, or is just a suggestion. But user should investigate further to determine if the suggestion makes sense.<td scope="col" class="warning col-sm-4"><small><b>warning</b> - There's a high probability that the issue is a violation, but further investigation is needed. Check with the <a href="https://tools.ietf.org/html/rfc7230" target="_blank">HTTP standards (RFC 7230-7235)</a> and <a href="http://tss.att.com/document/R113140.pdf" target="_blank">AT&T RESTful Standards</a>.</small></td><td scope="col" class="danger col-sm-4"><small><b>error</b> - The issue is a violation of a standard (HTTP, AT&T, etc) or best practice. This issue <em>must</em> be fixed. Check with the <a href="https://tools.ietf.org/html/rfc7230" target="_blank">HTTP standards (RFC 7230-7235)</a> and <a href="http://tss.att.com/document/R113140.pdf" target="_blank">AT&T RESTful Standards</a>.</small></td></small></td></tr></tbody></table></div></div></div></div></body></html>